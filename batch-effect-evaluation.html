<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Batch effect evaluation | SingleCellMQC</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Batch effect evaluation | SingleCellMQC" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Batch effect evaluation | SingleCellMQC" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::bs4_book,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Daihan Ji#, Mei Han#, Shuting Lu, Jiaying Zeng, Wen Zhong*" />


<meta name="date" content="2025-05-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="feature-qc.html"/>
<link rel="next" href="qc-html-report.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/core-js-2.5.3/shim.min.js"></script>
<script src="libs/react-18.2.0/react.min.js"></script>
<script src="libs/react-18.2.0/react-dom.min.js"></script>
<script src="libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/reactable-0.4.4/reactable.css" rel="stylesheet" />
<script src="libs/reactable-binding-0.4.4/reactable.js"></script>
<link href="libs/jquery-sparkline-2.1.2/jquery.sparkline.css" rel="stylesheet" />
<script src="libs/jquery-sparkline-2.1.2/jquery.sparkline.js"></script>
<script src="libs/sparkline-binding-2.0/sparkline.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> <strong>About</strong></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#bugs"><i class="fa fa-check"></i><b>1.3</b> Bugs</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="load-and-add-data.html"><a href="load-and-add-data.html"><i class="fa fa-check"></i><b>2</b> <strong>Load and add data</strong></a>
<ul>
<li class="chapter" data-level="2.1" data-path="load-and-add-data.html"><a href="load-and-add-data.html#loading-data-of-scrna-seq-or-cite-seq"><i class="fa fa-check"></i><b>2.1</b> Loading data of scRNA-seq or CITE-seq</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="load-and-add-data.html"><a href="load-and-add-data.html#data-import-without-bpcells"><i class="fa fa-check"></i><b>2.1.1</b> Data import Without BPCells</a></li>
<li class="chapter" data-level="2.1.2" data-path="load-and-add-data.html"><a href="load-and-add-data.html#data-import-with-bpcells"><i class="fa fa-check"></i><b>2.1.2</b> Data import With BPCells</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="load-and-add-data.html"><a href="load-and-add-data.html#loading-data-of-scvdj-seq"><i class="fa fa-check"></i><b>2.2</b> Loading data of scV(D)J-seq</a></li>
<li class="chapter" data-level="2.3" data-path="load-and-add-data.html"><a href="load-and-add-data.html#loading-data-of-multi-omics-scrna-seqcite-seq-scvdj-seq"><i class="fa fa-check"></i><b>2.3</b> Loading data of multi-omics (scRNA-seq/CITE-seq + scV(D)J-seq)</a></li>
<li class="chapter" data-level="2.4" data-path="load-and-add-data.html"><a href="load-and-add-data.html#loading-and-adding-10x-metrics"><i class="fa fa-check"></i><b>2.4</b> Loading and adding 10X metrics</a></li>
<li class="chapter" data-level="2.5" data-path="load-and-add-data.html"><a href="load-and-add-data.html#adding-information-of-samples"><i class="fa fa-check"></i><b>2.5</b> Adding information of samples</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sample-qc.html"><a href="sample-qc.html"><i class="fa fa-check"></i><b>3</b> <strong>Sample QC</strong></a>
<ul>
<li class="chapter" data-level="3.1" data-path="sample-qc.html"><a href="sample-qc.html#sample-quality-assessment"><i class="fa fa-check"></i><b>3.1</b> Sample quality assessment</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="sample-qc.html"><a href="sample-qc.html#x-metrics-assessment"><i class="fa fa-check"></i><b>3.1.1</b> 10X metrics assessment</a></li>
<li class="chapter" data-level="3.1.2" data-path="sample-qc.html"><a href="sample-qc.html#basic-metrics-assessment"><i class="fa fa-check"></i><b>3.1.2</b> Basic metrics assessment</a></li>
<li class="chapter" data-level="3.1.3" data-path="sample-qc.html"><a href="sample-qc.html#visualisation-of-vdj-data"><i class="fa fa-check"></i><b>3.1.3</b> Visualisation of V(D)J data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="sample-qc.html"><a href="sample-qc.html#pct-outlier-sample-detection"><i class="fa fa-check"></i><b>3.2</b> PCT outlier sample detection</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sample-qc.html"><a href="sample-qc.html#cell-type-annotation-sctype"><i class="fa fa-check"></i><b>3.2.1</b> Cell type annotation (ScType)</a></li>
<li class="chapter" data-level="3.2.2" data-path="sample-qc.html"><a href="sample-qc.html#comparison-of-predicted-results-with-cell-proportion-range-database"><i class="fa fa-check"></i><b>3.2.2</b> Comparison of predicted results with cell proportion range database</a></li>
<li class="chapter" data-level="3.2.3" data-path="sample-qc.html"><a href="sample-qc.html#inter-sample-outliers"><i class="fa fa-check"></i><b>3.2.3</b> Inter-sample outliers</a></li>
<li class="chapter" data-level="3.2.4" data-path="sample-qc.html"><a href="sample-qc.html#outlier-detection-for-metrics-with-different-cell-types"><i class="fa fa-check"></i><b>3.2.4</b> Outlier detection for metrics with different cell types</a></li>
<li class="chapter" data-level="3.2.5" data-path="sample-qc.html"><a href="sample-qc.html#visualisation-of-the-pct-of-cell-types"><i class="fa fa-check"></i><b>3.2.5</b> Visualisation of the PCT of cell types</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sample-qc.html"><a href="sample-qc.html#sample-identity-verification"><i class="fa fa-check"></i><b>3.3</b> Sample identity verification</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cell-qc.html"><a href="cell-qc.html"><i class="fa fa-check"></i><b>4</b> <strong>Cell QC</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="cell-qc.html"><a href="cell-qc.html#empty-droplets-detection-if-required"><i class="fa fa-check"></i><b>4.1</b> Empty droplets detection (If Required)</a></li>
<li class="chapter" data-level="4.2" data-path="cell-qc.html"><a href="cell-qc.html#low-quality-cells-detection"><i class="fa fa-check"></i><b>4.2</b> Low quality cells detection</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="cell-qc.html"><a href="cell-qc.html#fixed-cutoff"><i class="fa fa-check"></i><b>4.2.1</b> Fixed cutoff</a></li>
<li class="chapter" data-level="4.2.2" data-path="cell-qc.html"><a href="cell-qc.html#mad-method"><i class="fa fa-check"></i><b>4.2.2</b> MAD method</a></li>
<li class="chapter" data-level="4.2.3" data-path="cell-qc.html"><a href="cell-qc.html#miqc-method"><i class="fa fa-check"></i><b>4.2.3</b> miQC method</a></li>
<li class="chapter" data-level="4.2.4" data-path="cell-qc.html"><a href="cell-qc.html#ddqc-method"><i class="fa fa-check"></i><b>4.2.4</b> ddqc method</a></li>
<li class="chapter" data-level="4.2.5" data-path="cell-qc.html"><a href="cell-qc.html#run-multiple-methods"><i class="fa fa-check"></i><b>4.2.5</b> Run multiple methods</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="cell-qc.html"><a href="cell-qc.html#check-low-quality-cells-optional"><i class="fa fa-check"></i><b>4.3</b> Check low-quality cells (optional)</a></li>
<li class="chapter" data-level="4.4" data-path="cell-qc.html"><a href="cell-qc.html#doublets-detection"><i class="fa fa-check"></i><b>4.4</b> Doublets detection</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="cell-qc.html"><a href="cell-qc.html#scdblfinder-method"><i class="fa fa-check"></i><b>4.4.1</b> scDblFinder method</a></li>
<li class="chapter" data-level="4.4.2" data-path="cell-qc.html"><a href="cell-qc.html#hybrid-method"><i class="fa fa-check"></i><b>4.4.2</b> hybrid method</a></li>
<li class="chapter" data-level="4.4.3" data-path="cell-qc.html"><a href="cell-qc.html#bcds-method"><i class="fa fa-check"></i><b>4.4.3</b> bcds method</a></li>
<li class="chapter" data-level="4.4.4" data-path="cell-qc.html"><a href="cell-qc.html#cxds-method"><i class="fa fa-check"></i><b>4.4.4</b> cxds method</a></li>
<li class="chapter" data-level="4.4.5" data-path="cell-qc.html"><a href="cell-qc.html#doubletfinder-method"><i class="fa fa-check"></i><b>4.4.5</b> DoubletFinder method</a></li>
<li class="chapter" data-level="4.4.6" data-path="cell-qc.html"><a href="cell-qc.html#vdj-method"><i class="fa fa-check"></i><b>4.4.6</b> VDJ method</a></li>
<li class="chapter" data-level="4.4.7" data-path="cell-qc.html"><a href="cell-qc.html#adt-method"><i class="fa fa-check"></i><b>4.4.7</b> ADT method</a></li>
<li class="chapter" data-level="4.4.8" data-path="cell-qc.html"><a href="cell-qc.html#run-multiple-methods-1"><i class="fa fa-check"></i><b>4.4.8</b> Run multiple methods</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="cell-qc.html"><a href="cell-qc.html#visualization-of-cell-qc-results"><i class="fa fa-check"></i><b>4.5</b> Visualization of cell QC results</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="cell-qc.html"><a href="cell-qc.html#visualization-of-the-percentage-of-cells-filtered-by-different-methods"><i class="fa fa-check"></i><b>4.5.1</b> Visualization of the percentage of cells filtered by different methods</a></li>
<li class="chapter" data-level="4.5.2" data-path="cell-qc.html"><a href="cell-qc.html#overlap-between-different-methods-upset-plot"><i class="fa fa-check"></i><b>4.5.2</b> Overlap between different methods (UpSet plot)</a></li>
<li class="chapter" data-level="4.5.3" data-path="cell-qc.html"><a href="cell-qc.html#comparison-of-metrics-between-pass-and-fail-cells-identified-by-methods"><i class="fa fa-check"></i><b>4.5.3</b> Comparison of metrics between <em>Pass</em> and <em>Fail</em> cells identified by methods</a></li>
<li class="chapter" data-level="4.5.4" data-path="cell-qc.html"><a href="cell-qc.html#visualization-of-scatter-plots-for-cell-metrics"><i class="fa fa-check"></i><b>4.5.4</b> Visualization of scatter plots for cell metrics</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="cell-qc.html"><a href="cell-qc.html#filter-out-problematic-droplets-or-cells"><i class="fa fa-check"></i><b>4.6</b> Filter out problematic droplets or cells</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="feature-qc.html"><a href="feature-qc.html"><i class="fa fa-check"></i><b>5</b> <strong>Feature QC</strong></a>
<ul>
<li class="chapter" data-level="5.1" data-path="feature-qc.html"><a href="feature-qc.html#feature-quality-assessment"><i class="fa fa-check"></i><b>5.1</b> Feature quality assessment</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="feature-qc.html"><a href="feature-qc.html#calculating-feature-metrics"><i class="fa fa-check"></i><b>5.1.1</b> Calculating feature metrics</a></li>
<li class="chapter" data-level="5.1.2" data-path="feature-qc.html"><a href="feature-qc.html#reference-qc-thresholds-for-feature-qc"><i class="fa fa-check"></i><b>5.1.2</b> Reference QC thresholds for feature QC</a></li>
<li class="chapter" data-level="5.1.3" data-path="feature-qc.html"><a href="feature-qc.html#calculating-per-feature-variance-explained-by-batch-factors"><i class="fa fa-check"></i><b>5.1.3</b> Calculating per-feature variance explained by batch factors</a></li>
<li class="chapter" data-level="5.1.4" data-path="feature-qc.html"><a href="feature-qc.html#base-plots-of-feature-metrics"><i class="fa fa-check"></i><b>5.1.4</b> Base plots of feature metrics</a></li>
<li class="chapter" data-level="5.1.5" data-path="feature-qc.html"><a href="feature-qc.html#scatter-plot-of-the-feature-metrics"><i class="fa fa-check"></i><b>5.1.5</b> Scatter plot of the feature metrics</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="feature-qc.html"><a href="feature-qc.html#systematic-background-noise-correction"><i class="fa fa-check"></i><b>5.2</b> Systematic background noise correction</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="feature-qc.html"><a href="feature-qc.html#sccdc"><i class="fa fa-check"></i><b>5.2.1</b> scCDC</a></li>
<li class="chapter" data-level="5.2.2" data-path="feature-qc.html"><a href="feature-qc.html#decontx-rna"><i class="fa fa-check"></i><b>5.2.2</b> DecontX (RNA)</a></li>
<li class="chapter" data-level="5.2.3" data-path="feature-qc.html"><a href="feature-qc.html#decontpro-adt"><i class="fa fa-check"></i><b>5.2.3</b> DecontPro (ADT)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html"><i class="fa fa-check"></i><b>6</b> <strong>Batch effect evaluation</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#sample-level"><i class="fa fa-check"></i><b>6.1</b> Sample level</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#pca-of-pseudobulk-data-at-the-sample-level"><i class="fa fa-check"></i><b>6.1.1</b> PCA of pseudobulk data at the sample level</a></li>
<li class="chapter" data-level="6.1.2" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#performing-svd-analysis-and-calculating-r²-values"><i class="fa fa-check"></i><b>6.1.2</b> Performing SVD analysis and calculating R² values</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#cell-level"><i class="fa fa-check"></i><b>6.2</b> Cell level</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#rna-umap"><i class="fa fa-check"></i><b>6.2.1</b> RNA UMAP</a></li>
<li class="chapter" data-level="6.2.2" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#adt-umap"><i class="fa fa-check"></i><b>6.2.2</b> ADT UMAP</a></li>
<li class="chapter" data-level="6.2.3" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#rnaadt-umap"><i class="fa fa-check"></i><b>6.2.3</b> RNA+ADT UMAP</a></li>
<li class="chapter" data-level="6.2.4" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#harmony-umap"><i class="fa fa-check"></i><b>6.2.4</b> harmony UMAP</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#feature-level"><i class="fa fa-check"></i><b>6.3</b> Feature level</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#calculating-per-feature-variance-explained-by-variables-at-cell-level"><i class="fa fa-check"></i><b>6.3.1</b> Calculating per-feature variance explained by variables at cell level</a></li>
<li class="chapter" data-level="6.3.2" data-path="batch-effect-evaluation.html"><a href="batch-effect-evaluation.html#calculating-per-feature-variance-explained-by-variables-at-sample-level"><i class="fa fa-check"></i><b>6.3.2</b> Calculating per-feature variance explained by variables at sample level</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="qc-html-report.html"><a href="qc-html-report.html"><i class="fa fa-check"></i><b>7</b> <strong>QC HTML report</strong></a></li>
<li class="chapter" data-level="8" data-path="tips.html"><a href="tips.html"><i class="fa fa-check"></i><b>8</b> <strong>Tips</strong></a>
<ul>
<li class="chapter" data-level="8.1" data-path="tips.html"><a href="tips.html#progress-updates"><i class="fa fa-check"></i><b>8.1</b> Progress updates</a></li>
<li class="chapter" data-level="8.2" data-path="tips.html"><a href="tips.html#future-parallel"><i class="fa fa-check"></i><b>8.2</b> Future parallel</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">SingleCellMQC</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="batch-effect-evaluation" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> <strong>Batch effect evaluation</strong><a href="batch-effect-evaluation.html#batch-effect-evaluation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Compiled: 2025-05-08</strong>
<strong>Written by Shuting Lu and Daihan Ji</strong></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="batch-effect-evaluation.html#cb131-1" tabindex="-1"></a><span class="fu">library</span>(SingleCellMQC)</span>
<span id="cb131-2"><a href="batch-effect-evaluation.html#cb131-2" tabindex="-1"></a><span class="fu">library</span>(BPCells)</span>
<span id="cb131-3"><a href="batch-effect-evaluation.html#cb131-3" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span>
<span id="cb131-4"><a href="batch-effect-evaluation.html#cb131-4" tabindex="-1"></a><span class="co">#Load a pre-existing Seurat object or process raw data using SingleCellMQC.</span></span>
<span id="cb131-5"><a href="batch-effect-evaluation.html#cb131-5" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;/data/pbmc.rds&quot;</span>)</span></code></pre></div>
<p>Batch-to-batch variation is a significant challenge in single-cell analysis, where differences in protocols, reagents, and experimental conditions can introduce noise that obscures true biological signals and leads to misleading interpretations. To address this issue, SingleCellMQC evaluates batch effects at both sample and cell levels.</p>
<div id="sample-level" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Sample level<a href="batch-effect-evaluation.html#sample-level" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the sample level, SingleCellMQC generates pseudobulk sample data by aggregating single-cell counts for target cell populations. PCA is then applied to identify batch effects across samples. In addition, SingleCellMQC performs singular value decomposition (SVD) analysis and calculates R² values to determine batch-associated variables that are significantly associated with principal components, providing insights into the main drivers of batch effects.</p>
<div id="pca-of-pseudobulk-data-at-the-sample-level" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> PCA of pseudobulk data at the sample level<a href="batch-effect-evaluation.html#pca-of-pseudobulk-data-at-the-sample-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To visualize the distribution of antibody batches for RNA/ADT data, you can perform PCA on pseudobulk data by specifying <code>plot.type = "pseudobulk"</code> in the <code>PlotReducedDim</code> function. Here’s an example using the batch variable <code>Batch_TotalSeq_C_Antibodies</code> in ADT data:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="batch-effect-evaluation.html#cb132-1" tabindex="-1"></a><span class="do">## Perform PCA on pseudobulk ADT data, grouped by the batch variable: `Batch_TotalSeq_C_Antibodies`</span></span>
<span id="cb132-2"><a href="batch-effect-evaluation.html#cb132-2" tabindex="-1"></a><span class="fu">PlotReducedDim</span>(pbmc , <span class="at">plot.type =</span> <span class="st">&quot;pseudobulk&quot;</span>, <span class="at">assay=</span><span class="st">&quot;ADT&quot;</span>, </span>
<span id="cb132-3"><a href="batch-effect-evaluation.html#cb132-3" tabindex="-1"></a>               <span class="at">group.by.pseudobulk =</span> <span class="st">&quot;Batch_TotalSeq_C_Antibodies&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/PlotReducedDim_sample-1.png" width="672" /></p>
</div>
<div id="performing-svd-analysis-and-calculating-r²-values" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Performing SVD analysis and calculating R² values<a href="batch-effect-evaluation.html#performing-svd-analysis-and-calculating-r²-values" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To further investigate factors contributing to batch effects, SingleCellMQC performed SVD analysis and calculated R² values to analyze batch-associated variables. The PCA results from the ‘prcomp’ function were analyzed via Kruskal-Wallis tests (categorical variables) or linear regression (continuous variables) to detect the significance of the relationship between the variable and the PC scores. Additionally, the proportion of variance explained by batch-associated variables was quantified for each feature using ANOVA-derived R² (categorical) or regression-based R² (continuous).</p>
<p>For ADT data, the covariates <code>"nCount_ADT"</code>, <code>"Batch_TotalSeq_C_Antibodies"</code>, and <code>"Time_point"</code> are analyzed as follows:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="batch-effect-evaluation.html#cb133-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">PlotCovariateImpact</span>(pbmc, <span class="at">pseudobulk.sample.by =</span> <span class="st">&quot;orig.ident&quot;</span>, </span>
<span id="cb133-2"><a href="batch-effect-evaluation.html#cb133-2" tabindex="-1"></a>                    <span class="at">assay =</span> <span class="st">&quot;ADT&quot;</span>, </span>
<span id="cb133-3"><a href="batch-effect-evaluation.html#cb133-3" tabindex="-1"></a>                    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;nCount_ADT&quot;</span>, <span class="st">&quot;Batch_TotalSeq_C_Antibodies&quot;</span>, <span class="st">&quot;Time_point&quot;</span>))</span>
<span id="cb133-4"><a href="batch-effect-evaluation.html#cb133-4" tabindex="-1"></a><span class="co"># Verification of correlation between batch covariates and principal components.</span></span>
<span id="cb133-5"><a href="batch-effect-evaluation.html#cb133-5" tabindex="-1"></a>out<span class="sc">$</span>svd </span></code></pre></div>
<p><img src="_main_files/figure-html/PlotCovariateImpact_pbmc-1.png" width="672" /></p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="batch-effect-evaluation.html#cb134-1" tabindex="-1"></a><span class="co"># Display of the extent to which batch covariates contribute to the principal components</span></span>
<span id="cb134-2"><a href="batch-effect-evaluation.html#cb134-2" tabindex="-1"></a>out<span class="sc">$</span>explanatory</span></code></pre></div>
<p><img src="_main_files/figure-html/PlotCovariateImpact_pbmc-2.png" width="672" /></p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="batch-effect-evaluation.html#cb135-1" tabindex="-1"></a></span>
<span id="cb135-2"><a href="batch-effect-evaluation.html#cb135-2" tabindex="-1"></a><span class="co"># Presentation of results with interactive tables</span></span>
<span id="cb135-3"><a href="batch-effect-evaluation.html#cb135-3" tabindex="-1"></a>out<span class="ot">&lt;-</span><span class="fu">PlotCovariateImpact</span>(pbmc, <span class="at">variables =</span><span class="fu">c</span>(<span class="st">&quot;nCount_ADT&quot;</span>, <span class="st">&quot;Batch_TotalSeq_C_Antibodies&quot;</span>), <span class="at">assay =</span> <span class="st">&quot;ADT&quot;</span> , <span class="at">return.type =</span> <span class="st">&quot;interactive_table&quot;</span>)</span>
<span id="cb135-4"><a href="batch-effect-evaluation.html#cb135-4" tabindex="-1"></a>out<span class="sc">$</span>svd</span></code></pre></div>
<button onclick="Reactable.downloadDataCSV(&#39;ADT_SVD&#39;, &#39;ADT_SVD&#39;)">Download as CSV</button>
<p style="color:#000;background:#FFFFFF;text-align:left;font-size:16px;font-style:normal;font-weight:bold;text-decoration:none;text-transform:none;letter-spacing:normal;word-spacing:normal;text-shadow:none;margin-top:0.5px;margin-right:0px;margin-bottom:0.5px;margin-left:0px;">SVD significance pvalue</p>
<div class="reactable html-widget html-fill-item" id="ADT_SVD" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ADT_SVD">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Variable":["mean_nCount_ADT","Batch_TotalSeq_C_Antibodies"],"PC1":[0.509669700340874,0.179712494879],"PC2":[0.869330388297807,0.654720846018578],"PC3":[0.138314645700771,0.654720846018578]},"columns":[{"id":"Variable","name":"Variable","type":"character","maxWidth":85,"align":"left","filterable":true,"filterInput":{"name":"select","attribs":{"aria-label":"Filter Variable","style":{"width":"100%","height":"28px"},"onChange":"function(_e){(function(event){Reactable.setFilter('ADT_SVD', 'Variable', event.target.value || undefined)}).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":""},"children":["All"]},{"name":"option","attribs":{},"children":["mean_nCount_ADT"]},{"name":"option","attribs":{},"children":["Batch_TotalSeq_C_Antibodies"]}]},"sticky":"left","style":{"background":"#f7f7f7"}},{"id":"PC1","name":"PC1","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"6e29268efe40a83b3568f7fa23dda58c"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-06eac5d7e461b0e47d96","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-06eac5d7e461b0e47d96"},"children":["{\"x\":{\"values\":[0.5096697003408737,0.1797124948789997],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"maxWidth":85,"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["0.51","0.18"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 35.2605804815954%, transparent 35.2605804815954%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"PC2","name":"PC2","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"ec44f122a9571b48bd7f2ed4464b422b"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-9a4de4021329bd2555cd","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-9a4de4021329bd2555cd"},"children":["{\"x\":{\"values\":[0.8693303882978073,0.6547208460185777],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"maxWidth":85,"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["0.869","0.655"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 75.3132358918862%, transparent 75.3132358918862%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"PC3","name":"PC3","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"739c14441965d67962e83c8e38d07ce9"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-06027573c20c2a9cb9f7","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-06027573c20c2a9cb9f7"},"children":["{\"x\":{\"values\":[0.1383146457007705,0.6547208460185777],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"maxWidth":85,"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["0.138","0.655"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 21.1257433670969%, transparent 21.1257433670969%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"showPagination":true,"theme":{"color":"#141415","backgroundColor":"#f8f9fa","borderColor":"#f8f9fa","borderWidth":"1px","stripedColor":"white","highlightColor":"white","cellPadding":4,"tableStyle":{"fontSize":14},"headerStyle":{"borderWidth":"2px","backgroundColor":"#373a3c","color":"#ffffff","transitionDuration":"0.5s","&:hover[aria-sort]":{"color":"#ffffff"},"&[aria-sort='ascending'], &[aria-sort='descending']":{"color":"#ffffff"},"fontSize":14},"groupHeaderStyle":{"&:not(:empty)":{"color":"#141415","fontSize":14},"&:hover":{"fontWeight":"bold","transitionDuration":"1s","transitionTimingFunction":"ease-out","color":"#111111"}},"rowSelectedStyle":{"backgroundColor":"#78c2ad","color":"#ffffff"},"inputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a"},"searchInputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a","borderColor":"#b3cecc","&:focus":{"color":"#888888"}},"selectStyle":{"backgroundColor":"#2780e3","color":"#ffffff","borderColor":"#ffffff","outlineColor":"#ffffff"},"pageButtonStyle":{"backgroundColor":"#ffffff","color":"#2780e3","&:hover":{"backgroundColor":"#2780e3","color":"#ffffff"}},"pageButtonHoverStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonActiveStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonCurrentStyle":{"backgroundColor":"#2780e3","color":"#ffffff"}},"elementId":"ADT_SVD","dataKey":"de214610033a655d90747e097f12118c"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.filterInput.attribs.onChange","tag.attribs.columns.1.filterMethod","tag.attribs.columns.2.filterMethod","tag.attribs.columns.3.filterMethod"],"jsHooks":[]}</script>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="batch-effect-evaluation.html#cb136-1" tabindex="-1"></a>out<span class="sc">$</span>explanatory</span></code></pre></div>
<button onclick="Reactable.downloadDataCSV(&#39;ADT_Explanatory&#39;, &#39;ADT_Explanatory&#39;)">Download as CSV</button>
<p style="color:#000;background:#FFFFFF;text-align:left;font-size:16px;font-style:normal;font-weight:bold;text-decoration:none;text-transform:none;letter-spacing:normal;word-spacing:normal;text-shadow:none;margin-top:0.5px;margin-right:0px;margin-bottom:0.5px;margin-left:0px;">Explanatory PCs for each variable</p>
<div class="reactable html-widget html-fill-item" id="ADT_Explanatory" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ADT_Explanatory">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"PCs":["PC1","PC2","PC3"],"mean_nCount_ADT":[24.0423802763809,1.70745474224019,74.2501649813789],"Batch_TotalSeq_C_Antibodies":[70.6493372373452,28.9584654519979,0.392197310656828],"Sparkline":[[24.0423802763809,70.6493372373452],[1.70745474224019,28.9584654519979],[74.2501649813789,0.392197310656828]]},"columns":[{"id":"PCs","name":"PCs","type":"character","maxWidth":85,"align":"left","filterable":true,"filterInput":{"name":"select","attribs":{"aria-label":"Filter PCs","style":{"width":"100%","height":"28px"},"onChange":"function(_e){(function(event){Reactable.setFilter('ADT_Explanatory', 'PCs', event.target.value || undefined)}).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":""},"children":["All"]},{"name":"option","attribs":{},"children":["PC1"]},{"name":"option","attribs":{},"children":["PC2"]},{"name":"option","attribs":{},"children":["PC3"]}]},"sticky":"left","style":{"background":"#f7f7f7"}},{"id":"mean_nCount_ADT","name":"mean_nCount_ADT","type":"numeric","maxWidth":85,"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["24.04%","1.71%","74.25%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 32.3802381885757%, transparent 32.3802381885757%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 2.29959723681207%, transparent 2.29959723681207%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Batch_TotalSeq_C_Antibodies","name":"Batch_TotalSeq_C_Antibodies","type":"numeric","maxWidth":85,"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["70.65%","28.96%","0.39%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 40.9890121894738%, transparent 40.9890121894738%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 0.555132328190494%, transparent 0.555132328190494%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Sparkline","name":"Sparkline","type":"list","maxWidth":85,"align":"left","cell":[{"name":"WidgetContainer","attribs":{"key":"416f28fd36fc4ca6631b906a4c3fd1da"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-0fc2b70baa9d6c3e972d","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-0fc2b70baa9d6c3e972d"},"children":["{\"x\":{\"values\":[24.04238027638088,70.64933723734521],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"ac34ba121e349bf9ca8fe9dfa1e74587"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-9eaf0b7150118a1d0022","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-9eaf0b7150118a1d0022"},"children":["{\"x\":{\"values\":[1.707454742240189,28.95846545199788],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"c1c2ed3a2404e44160b4eb8afe772d3e"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-9db015f3e92ce7018726","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-9db015f3e92ce7018726"},"children":["{\"x\":{\"values\":[74.25016498137889,0.3921973106568277],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]}],"sticky":"right","style":{"background":"#f7f7f7"}}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"showPagination":true,"theme":{"color":"#141415","backgroundColor":"#f8f9fa","borderColor":"#f8f9fa","borderWidth":"1px","stripedColor":"white","highlightColor":"white","cellPadding":4,"tableStyle":{"fontSize":14},"headerStyle":{"borderWidth":"2px","backgroundColor":"#373a3c","color":"#ffffff","transitionDuration":"0.5s","&:hover[aria-sort]":{"color":"#ffffff"},"&[aria-sort='ascending'], &[aria-sort='descending']":{"color":"#ffffff"},"fontSize":14},"groupHeaderStyle":{"&:not(:empty)":{"color":"#141415","fontSize":14},"&:hover":{"fontWeight":"bold","transitionDuration":"1s","transitionTimingFunction":"ease-out","color":"#111111"}},"rowSelectedStyle":{"backgroundColor":"#78c2ad","color":"#ffffff"},"inputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a"},"searchInputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a","borderColor":"#b3cecc","&:focus":{"color":"#888888"}},"selectStyle":{"backgroundColor":"#2780e3","color":"#ffffff","borderColor":"#ffffff","outlineColor":"#ffffff"},"pageButtonStyle":{"backgroundColor":"#ffffff","color":"#2780e3","&:hover":{"backgroundColor":"#2780e3","color":"#ffffff"}},"pageButtonHoverStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonActiveStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonCurrentStyle":{"backgroundColor":"#2780e3","color":"#ffffff"}},"elementId":"ADT_Explanatory","dataKey":"59e8c81530e089c5b58411e7306cd23f"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.filterInput.attribs.onChange","tag.attribs.columns.1.filterMethod","tag.attribs.columns.2.filterMethod"],"jsHooks":[]}</script>
<ul>
<li>If you want to analyze based on a specific column (e.g., cell type annotations), you can split the data by cell type. For instance, if you have run <code>RunScType</code> and obtained cell type annotations stored in the ScType column, you can perform SVD analysis and variance explanation (R²) for each sample split by cell type.</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="batch-effect-evaluation.html#cb137-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">PlotCovariateImpact</span>(pbmc, <span class="at">pseudobulk.sample.by =</span> <span class="st">&quot;orig.ident&quot;</span>, </span>
<span id="cb137-2"><a href="batch-effect-evaluation.html#cb137-2" tabindex="-1"></a>                    <span class="at">assay =</span> <span class="st">&quot;ADT&quot;</span>, <span class="at">pseudobulk.celltype.by=</span> <span class="st">&quot;ScType&quot;</span>,</span>
<span id="cb137-3"><a href="batch-effect-evaluation.html#cb137-3" tabindex="-1"></a>                    <span class="at">variables =</span> <span class="fu">c</span>(<span class="st">&quot;nCount_ADT&quot;</span>, <span class="st">&quot;Batch_TotalSeq_C_Antibodies&quot;</span>, <span class="st">&quot;Time_point&quot;</span>),</span>
<span id="cb137-4"><a href="batch-effect-evaluation.html#cb137-4" tabindex="-1"></a>                    <span class="at">return.type =</span> <span class="st">&quot;interactive_table&quot;</span>)</span>
<span id="cb137-5"><a href="batch-effect-evaluation.html#cb137-5" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:14-------- Split Seurat Object</span></span>
<span id="cb137-6"><a href="batch-effect-evaluation.html#cb137-6" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:16 svd  all</span></span>
<span id="cb137-7"><a href="batch-effect-evaluation.html#cb137-7" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:17 svd  B cell</span></span>
<span id="cb137-8"><a href="batch-effect-evaluation.html#cb137-8" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:17 svd  DC</span></span>
<span id="cb137-9"><a href="batch-effect-evaluation.html#cb137-9" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:17 svd  Mon/Mac</span></span>
<span id="cb137-10"><a href="batch-effect-evaluation.html#cb137-10" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:18 svd  NK</span></span>
<span id="cb137-11"><a href="batch-effect-evaluation.html#cb137-11" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:18 svd  Other</span></span>
<span id="cb137-12"><a href="batch-effect-evaluation.html#cb137-12" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:19 svd  T cell</span></span>
<span id="cb137-13"><a href="batch-effect-evaluation.html#cb137-13" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:19 explanatory  all</span></span>
<span id="cb137-14"><a href="batch-effect-evaluation.html#cb137-14" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:20 explanatory  B cell</span></span>
<span id="cb137-15"><a href="batch-effect-evaluation.html#cb137-15" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:20 explanatory  DC</span></span>
<span id="cb137-16"><a href="batch-effect-evaluation.html#cb137-16" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:21 explanatory  Mon/Mac</span></span>
<span id="cb137-17"><a href="batch-effect-evaluation.html#cb137-17" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:21 explanatory  NK</span></span>
<span id="cb137-18"><a href="batch-effect-evaluation.html#cb137-18" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:22 explanatory  Other</span></span>
<span id="cb137-19"><a href="batch-effect-evaluation.html#cb137-19" tabindex="-1"></a><span class="do">## 2025-05-08 00:25:22 explanatory  T cell</span></span>
<span id="cb137-20"><a href="batch-effect-evaluation.html#cb137-20" tabindex="-1"></a><span class="co"># Display of the correlation between the covariates of the batch and the principal component PC1</span></span>
<span id="cb137-21"><a href="batch-effect-evaluation.html#cb137-21" tabindex="-1"></a>out<span class="sc">$</span>svd<span class="sc">$</span>PC1 </span></code></pre></div>
<button onclick="Reactable.downloadDataCSV(&#39;ADT_SVDtable_PC1&#39;, &#39;ADT_SVD_PC1&#39;)">Download as CSV</button>
<p style="color:#000;background:#FFFFFF;text-align:left;font-size:16px;font-style:normal;font-weight:bold;text-decoration:none;text-transform:none;letter-spacing:normal;word-spacing:normal;text-shadow:none;margin-top:0.5px;margin-right:0px;margin-bottom:0.5px;margin-left:0px;">SVD significance pvalue (PC1)</p>
<div class="reactable html-widget html-fill-item" id="ADT_SVDtable_PC1" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ADT_SVDtable_PC1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Group":["B cell","DC","Mon/Mac","NK","Other","T cell","all"],"Batch_TotalSeq_C_Antibodies":[0.179712494879,0.179712494879,0.179712494879,0.179712494879,0.179712494879,0.654720846018578,0.179712494879],"Time_point":[0.259240260645892,0.860707976425057,0.860707976425057,0.860707976425057,0.860707976425057,0.406569659740599,0.860707976425057],"mean_nCount_ADT":[0.42655181707017,0.790942270531298,0.128578993470329,0.85934437502484,0.452926180221349,0.889329009049042,0.509669700340874],"Sparkline":[[0.179712494879,0.259240260645892,0.42655181707017],[0.179712494879,0.860707976425057,0.790942270531298],[0.179712494879,0.860707976425057,0.128578993470329],[0.179712494879,0.860707976425057,0.85934437502484],[0.179712494879,0.860707976425057,0.452926180221349],[0.654720846018578,0.406569659740599,0.889329009049042],[0.179712494879,0.860707976425057,0.509669700340874]]},"columns":[{"id":"Group","name":"Group","type":"character","align":"left","filterable":true,"filterInput":{"name":"select","attribs":{"aria-label":"Filter Group","style":{"width":"100%","height":"28px"},"onChange":"function(_e){(function(event){Reactable.setFilter('ADT_SVDtable_PC1', 'Group', event.target.value || undefined)}).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":""},"children":["All"]},{"name":"option","attribs":{},"children":["B cell"]},{"name":"option","attribs":{},"children":["DC"]},{"name":"option","attribs":{},"children":["Mon/Mac"]},{"name":"option","attribs":{},"children":["NK"]},{"name":"option","attribs":{},"children":["Other"]},{"name":"option","attribs":{},"children":["T cell"]},{"name":"option","attribs":{},"children":["all"]}]},"sticky":"left","style":{"background":"#f7f7f7"}},{"id":"Batch_TotalSeq_C_Antibodies","name":"Batch_TotalSeq_C_Antibodies","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"3b9ff33b05082a9de393ca0ac171e2eb"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-fb578c5ed80fc87c95a6","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-fb578c5ed80fc87c95a6"},"children":["{\"x\":{\"values\":[0.1797124948789997,0.1797124948789997,0.1797124948789997,0.1797124948789997,0.1797124948789997,0.6547208460185777,0.1797124948789997],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["0.18","0.18","0.18","0.18","0.18","0.655","0.18"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 27.4487204694717%, transparent 27.4487204694717%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 27.4487204694717%, transparent 27.4487204694717%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 27.4487204694717%, transparent 27.4487204694717%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 27.4487204694717%, transparent 27.4487204694717%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 27.4487204694717%, transparent 27.4487204694717%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 27.4487204694717%, transparent 27.4487204694717%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Time_point","name":"Time_point","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"9c363be7424d27af743f1e2c163f65f0"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-363a1221d965eee60534","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-363a1221d965eee60534"},"children":["{\"x\":{\"values\":[0.2592402606458916,0.8607079764250575,0.8607079764250575,0.8607079764250575,0.8607079764250575,0.406569659740599,0.8607079764250575],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["0.259","0.861","0.861","0.861","0.861","0.407","0.861"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 30.1194211912202%, transparent 30.1194211912202%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 47.2366552741015%, transparent 47.2366552741015%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"mean_nCount_ADT","name":"mean_nCount_ADT","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"12e7a26f6d6a46c0b5ec21a77bc727c2"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-59a17abcaac00c606cff","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-59a17abcaac00c606cff"},"children":["{\"x\":{\"values\":[0.4265518170701703,0.7909422705312977,0.1285789934703288,0.8593443750248404,0.4529261802213488,0.8893290090490416,0.5096697003408737],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["0.427","0.791","0.129","0.859","0.453","0.889","0.51"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 47.9633310878144%, transparent 47.9633310878144%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 88.9369696122981%, transparent 88.9369696122981%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 14.4579781118147%, transparent 14.4579781118147%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 96.6283980710059%, transparent 96.6283980710059%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 50.9289785459334%, transparent 50.9289785459334%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 57.3094653558937%, transparent 57.3094653558937%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Sparkline","name":"Sparkline","type":"list","align":"left","cell":[{"name":"WidgetContainer","attribs":{"key":"b40ea2965f2f8da8104f02b6e6567063"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-02d198562bb4d80b846c","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-02d198562bb4d80b846c"},"children":["{\"x\":{\"values\":[0.1797124948789997,0.2592402606458916,0.4265518170701703],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"9df20557c3efd6c1fe4f8c5bad2fe749"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-7a30448e61447177b5ef","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-7a30448e61447177b5ef"},"children":["{\"x\":{\"values\":[0.1797124948789997,0.8607079764250575,0.7909422705312977],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"eba763f8667edb6a767a9770cec82be2"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-e99269143e492b2a5d73","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-e99269143e492b2a5d73"},"children":["{\"x\":{\"values\":[0.1797124948789997,0.8607079764250575,0.1285789934703288],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"0378fe642c628394bbf1a6a396bfcc52"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-c2713ffe982055f6a729","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-c2713ffe982055f6a729"},"children":["{\"x\":{\"values\":[0.1797124948789997,0.8607079764250575,0.8593443750248404],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"16ea6125189c018c47030ddb23a2ccb8"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-8c9b16fcd391b4dc805c","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-8c9b16fcd391b4dc805c"},"children":["{\"x\":{\"values\":[0.1797124948789997,0.8607079764250575,0.4529261802213488],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"6697cdd41e1db119703c20e3f2911477"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-6efc38c90216718b50f6","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-6efc38c90216718b50f6"},"children":["{\"x\":{\"values\":[0.6547208460185777,0.406569659740599,0.8893290090490416],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"c9c9dc74b5ddddd300bfb83784f8749e"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-3df69cc24ed4c0885633","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-3df69cc24ed4c0885633"},"children":["{\"x\":{\"values\":[0.1797124948789997,0.8607079764250575,0.5096697003408737],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]}],"sticky":"right","style":{"background":"#f7f7f7"}}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"showPagination":true,"theme":{"color":"#141415","backgroundColor":"#f8f9fa","borderColor":"#f8f9fa","borderWidth":"1px","stripedColor":"white","highlightColor":"white","cellPadding":4,"tableStyle":{"fontSize":14},"headerStyle":{"borderWidth":"2px","backgroundColor":"#373a3c","color":"#ffffff","transitionDuration":"0.5s","&:hover[aria-sort]":{"color":"#ffffff"},"&[aria-sort='ascending'], &[aria-sort='descending']":{"color":"#ffffff"},"fontSize":14},"groupHeaderStyle":{"&:not(:empty)":{"color":"#141415","fontSize":14},"&:hover":{"fontWeight":"bold","transitionDuration":"1s","transitionTimingFunction":"ease-out","color":"#111111"}},"rowSelectedStyle":{"backgroundColor":"#78c2ad","color":"#ffffff"},"inputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a"},"searchInputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a","borderColor":"#b3cecc","&:focus":{"color":"#888888"}},"selectStyle":{"backgroundColor":"#2780e3","color":"#ffffff","borderColor":"#ffffff","outlineColor":"#ffffff"},"pageButtonStyle":{"backgroundColor":"#ffffff","color":"#2780e3","&:hover":{"backgroundColor":"#2780e3","color":"#ffffff"}},"pageButtonHoverStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonActiveStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonCurrentStyle":{"backgroundColor":"#2780e3","color":"#ffffff"}},"elementId":"ADT_SVDtable_PC1","dataKey":"d2d7ee6bd972cc0f07a46ef1341f91b4"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.filterInput.attribs.onChange","tag.attribs.columns.1.filterMethod","tag.attribs.columns.2.filterMethod","tag.attribs.columns.3.filterMethod"],"jsHooks":[]}</script>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="batch-effect-evaluation.html#cb138-1" tabindex="-1"></a><span class="co"># Display of the contribution of the batch covariates to the principal component PC1</span></span>
<span id="cb138-2"><a href="batch-effect-evaluation.html#cb138-2" tabindex="-1"></a>out<span class="sc">$</span>explanatory<span class="sc">$</span>PC1</span></code></pre></div>
<button onclick="Reactable.downloadDataCSV(&#39;ADT_explanatorytable_PC1&#39;, &#39;ADT_explanatoryPC1&#39;)">Download as CSV</button>
<p style="color:#000;background:#FFFFFF;text-align:left;font-size:16px;font-style:normal;font-weight:bold;text-decoration:none;text-transform:none;letter-spacing:normal;word-spacing:normal;text-shadow:none;margin-top:0.5px;margin-right:0px;margin-bottom:0.5px;margin-left:0px;">Explanatory PCs for each variable (PC1)</p>
<div class="reactable html-widget html-fill-item" id="ADT_explanatorytable_PC1" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="ADT_explanatorytable_PC1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["mean_nCount_ADT","Batch_TotalSeq_C_Antibodies","Time_point"],"B cell":[32.8842818505523,97.3347696815537,49.2745068437977],"DC":[4.3705134250609,20.0086489858435,23.7513689825281],"Mon/Mac":[75.9374570621185,28.6453190262265,15.8395500948593],"NK":[1.97840048371528,34.0649943118756,28.0053789514079],"Other":[29.9289764287204,88.6021888182589,24.1213566333454],"T cell":[1.22480682380672,25.3274978945275,29.3223804755921],"all":[24.0423802763809,70.6493372373452,7.95533863861124],"Sparkline":[[32.8842818505523,4.3705134250609,75.9374570621185,1.97840048371528,29.9289764287204,1.22480682380672,24.0423802763809],[97.3347696815537,20.0086489858435,28.6453190262265,34.0649943118756,88.6021888182589,25.3274978945275,70.6493372373452],[49.2745068437977,23.7513689825281,15.8395500948593,28.0053789514079,24.1213566333454,29.3223804755921,7.95533863861124]]},"columns":[{"id":"variable","name":"variable","type":"factor","align":"left","filterable":true,"filterInput":{"name":"select","attribs":{"aria-label":"Filter variable","style":{"width":"100%","height":"28px"},"onChange":"function(_e){(function(event){Reactable.setFilter('ADT_explanatorytable_PC1', 'variable', event.target.value || undefined)}).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":""},"children":["All"]},{"name":"option","attribs":{},"children":["mean_nCount_ADT"]},{"name":"option","attribs":{},"children":["Batch_TotalSeq_C_Antibodies"]},{"name":"option","attribs":{},"children":["Time_point"]}]},"sticky":"left","style":{"background":"#f7f7f7"}},{"id":"B cell","name":"B cell","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"0004556b132b866833d5e820e39434c5"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-d6985ff78eea107e8c81","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-d6985ff78eea107e8c81"},"children":["{\"x\":{\"values\":[32.88428185055226,97.33476968155372,49.27450684379765],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["32.88%","97.33%","49.27%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 33.7847225181078%, transparent 33.7847225181078%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 50.6237462779304%, transparent 50.6237462779304%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"DC","name":"DC","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"345cd2b70b842a3faff49054e90df253"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-e0a6e4376c114cf85c1b","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-e0a6e4376c114cf85c1b"},"children":["{\"x\":{\"values\":[4.370513425060896,20.00864898584355,23.75136898252808],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["4.37%","20.01%","23.75%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 18.401101125059%, transparent 18.401101125059%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 84.2420872690002%, transparent 84.2420872690002%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Mon/Mac","name":"Mon/Mac","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"351c1cb14b8c2b8f496ad848289b1800"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-33f8cb8c3b64ac03f482","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-33f8cb8c3b64ac03f482"},"children":["{\"x\":{\"values\":[75.93745706211851,28.64531902622648,15.83955009485934],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["75.94%","28.65%","15.84%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 37.7222521459916%, transparent 37.7222521459916%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 20.8586785858555%, transparent 20.8586785858555%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"NK","name":"NK","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"99d74e69cec98d2485668eb18feea182"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-c2e3f85f1505aab108a5","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-c2e3f85f1505aab108a5"},"children":["{\"x\":{\"values\":[1.978400483715281,34.06499431187563,28.00537895140787],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["1.98%","34.06%","28.01%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 5.80772292401522%, transparent 5.80772292401522%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 82.2116061285961%, transparent 82.2116061285961%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Other","name":"Other","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"304644e42d6e6cfa5ef2633d1be00626"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-49123bdc34cfcd8051dd","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-49123bdc34cfcd8051dd"},"children":["{\"x\":{\"values\":[29.92897642872039,88.60218881825894,24.12135663334536],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["29.93%","88.6%","24.12%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 33.779048608055%, transparent 33.779048608055%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 27.2243349233992%, transparent 27.2243349233992%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"T cell","name":"T cell","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"f669d9a662427712e64056cef2857108"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-1ce2471f85ac05868f12","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-1ce2471f85ac05868f12"},"children":["{\"x\":{\"values\":[1.224806823806723,25.32749789452751,29.32238047559215],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["1.22%","25.33%","29.32%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 4.17703748447793%, transparent 4.17703748447793%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 86.3759950035777%, transparent 86.3759950035777%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"all","name":"all","type":"numeric","footer":{"name":"WidgetContainer","attribs":{"key":"26b066119337a194f28746838dcd067e"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-f0bb5bd473829bebfb32","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-f0bb5bd473829bebfb32"},"children":["{\"x\":{\"values\":[24.04238027638088,70.64933723734521,7.955338638611242],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},"align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["24.04%","70.65%","7.96%"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 34.030581483887%, transparent 34.030581483887%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 11.2603160195055%, transparent 11.2603160195055%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Sparkline","name":"Sparkline","type":"list","align":"left","cell":[{"name":"WidgetContainer","attribs":{"key":"d03d4b8fa2be8d5b6bb9e95bb679dd9d"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-0e86b177498c2da849fd","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-0e86b177498c2da849fd"},"children":["{\"x\":{\"values\":[32.88428185055226,4.370513425060896,75.93745706211851,1.978400483715281,29.92897642872039,1.224806823806723,24.04238027638088],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"c1f1a0594a9e339180cdceb32e227583"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-b048224f8d9c4559ef5a","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-b048224f8d9c4559ef5a"},"children":["{\"x\":{\"values\":[97.33476968155372,20.00864898584355,28.64531902622648,34.06499431187563,88.60218881825894,25.32749789452751,70.64933723734521],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]},{"name":"WidgetContainer","attribs":{"key":"08cde859f799adf5d0f15286f7e405a0"},"children":[{"name":"Fragment","attribs":[],"children":[{"name":"span","attribs":{"id":"htmlwidget-cf9ec449514c1120b8fb","className":"sparkline html-widget"},"children":[]},{"name":"script","attribs":{"type":"application/json","data-for":"htmlwidget-cf9ec449514c1120b8fb"},"children":["{\"x\":{\"values\":[49.27450684379765,23.75136898252808,15.83955009485934,28.00537895140787,24.12135663334536,29.32238047559215,7.955338638611242],\"options\":{\"type\":\"line\",\"height\":20,\"width\":60},\"width\":60,\"height\":20},\"evals\":[],\"jsHooks\":[]}"]}]}]}],"sticky":"right","style":{"background":"#f7f7f7"}}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"showPagination":true,"theme":{"color":"#141415","backgroundColor":"#f8f9fa","borderColor":"#f8f9fa","borderWidth":"1px","stripedColor":"white","highlightColor":"white","cellPadding":4,"tableStyle":{"fontSize":14},"headerStyle":{"borderWidth":"2px","backgroundColor":"#373a3c","color":"#ffffff","transitionDuration":"0.5s","&:hover[aria-sort]":{"color":"#ffffff"},"&[aria-sort='ascending'], &[aria-sort='descending']":{"color":"#ffffff"},"fontSize":14},"groupHeaderStyle":{"&:not(:empty)":{"color":"#141415","fontSize":14},"&:hover":{"fontWeight":"bold","transitionDuration":"1s","transitionTimingFunction":"ease-out","color":"#111111"}},"rowSelectedStyle":{"backgroundColor":"#78c2ad","color":"#ffffff"},"inputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a"},"searchInputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a","borderColor":"#b3cecc","&:focus":{"color":"#888888"}},"selectStyle":{"backgroundColor":"#2780e3","color":"#ffffff","borderColor":"#ffffff","outlineColor":"#ffffff"},"pageButtonStyle":{"backgroundColor":"#ffffff","color":"#2780e3","&:hover":{"backgroundColor":"#2780e3","color":"#ffffff"}},"pageButtonHoverStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonActiveStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonCurrentStyle":{"backgroundColor":"#2780e3","color":"#ffffff"}},"elementId":"ADT_explanatorytable_PC1","dataKey":"33e8073c1a47af0fdadeb14dd3546d6a"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.filterInput.attribs.onChange","tag.attribs.columns.1.filterMethod","tag.attribs.columns.2.filterMethod","tag.attribs.columns.3.filterMethod","tag.attribs.columns.4.filterMethod","tag.attribs.columns.5.filterMethod","tag.attribs.columns.6.filterMethod","tag.attribs.columns.7.filterMethod"],"jsHooks":[]}</script>
</div>
</div>
<div id="cell-level" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Cell level<a href="batch-effect-evaluation.html#cell-level" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the cell level, SingleCellMQC performs UMAP analysis on the original single-cell data to visualize batch-related variability. This approach is adaptable to both single-omics and multi-omics datasets. Additionally, SingleCellMQC also integrates the harmony method for batch correction. Users can compare the data before and after correction through UMAP visualizations. Moreover, SingleCellMQC calculates the percentage of variance explained by different variables for both RNA and surface protein features in the original single-cell data at the cell level. This method enables users to identify specific batch covariates that impact feature expression.</p>
<p>The <em>RunPipeline()</em> function must be used to flow through the data to obtain the results of the clustering prior to the assessment of the batch effect.</p>
<div id="rna-umap" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> RNA UMAP<a href="batch-effect-evaluation.html#rna-umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="batch-effect-evaluation.html#cb139-1" tabindex="-1"></a><span class="co"># RNA umap</span></span>
<span id="cb139-2"><a href="batch-effect-evaluation.html#cb139-2" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RunPipeline</span>(pbmc, <span class="at">preprocess=</span><span class="st">&quot;rna.umap&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="batch-effect-evaluation.html#cb140-1" tabindex="-1"></a><span class="do">## UMAP plot</span></span>
<span id="cb140-2"><a href="batch-effect-evaluation.html#cb140-2" tabindex="-1"></a><span class="fu">PlotReducedDim</span>(pbmc , <span class="at">group.by =</span> <span class="st">&quot;rna_cluster&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;rna.umap&quot;</span>, <span class="at">split.by =</span> <span class="st">&quot;orig.ident&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/PlotReducedDim_RNA-1.png" width="672" /></p>
</div>
<div id="adt-umap" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> ADT UMAP<a href="batch-effect-evaluation.html#adt-umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="batch-effect-evaluation.html#cb141-1" tabindex="-1"></a><span class="co"># ADT umap</span></span>
<span id="cb141-2"><a href="batch-effect-evaluation.html#cb141-2" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RunPipeline</span>(pbmc, <span class="at">preprocess=</span><span class="st">&quot;adt.umap&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="batch-effect-evaluation.html#cb142-1" tabindex="-1"></a><span class="do">## UMAP plot</span></span>
<span id="cb142-2"><a href="batch-effect-evaluation.html#cb142-2" tabindex="-1"></a><span class="fu">PlotReducedDim</span>(pbmc , <span class="at">group.by =</span> <span class="st">&quot;adt_cluster&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;adt.umap&quot;</span>, <span class="at">split.by =</span> <span class="st">&quot;orig.ident&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/PlotReducedDim_ADT-1.png" width="672" /></p>
</div>
<div id="rnaadt-umap" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> RNA+ADT UMAP<a href="batch-effect-evaluation.html#rnaadt-umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For CITE-seq data, CITE-seq data was integrated using Weighted Nearest Neighbor (WNN) analysis in the Seurat package.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="batch-effect-evaluation.html#cb143-1" tabindex="-1"></a><span class="co"># WNN umap</span></span>
<span id="cb143-2"><a href="batch-effect-evaluation.html#cb143-2" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RunPipeline</span>(pbmc, <span class="at">preprocess=</span><span class="st">&quot;wnn.umap&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="batch-effect-evaluation.html#cb144-1" tabindex="-1"></a><span class="do">## UMAP plot</span></span>
<span id="cb144-2"><a href="batch-effect-evaluation.html#cb144-2" tabindex="-1"></a><span class="fu">PlotReducedDim</span>(pbmc , <span class="at">group.by =</span> <span class="st">&quot;wnn_clusters&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;wnn.umap&quot;</span>, <span class="at">split.by =</span> <span class="st">&quot;orig.ident&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/PlotReducedDim_WNN-1.png" width="672" /></p>
</div>
<div id="harmony-umap" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> harmony UMAP<a href="batch-effect-evaluation.html#harmony-umap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="batch-effect-evaluation.html#cb145-1" tabindex="-1"></a><span class="co"># WNN harmony umap</span></span>
<span id="cb145-2"><a href="batch-effect-evaluation.html#cb145-2" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RunPipeline</span>(pbmc, <span class="at">preprocess=</span><span class="st">&quot;wnn.umap.har&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="batch-effect-evaluation.html#cb146-1" tabindex="-1"></a><span class="do">## UMAP plot</span></span>
<span id="cb146-2"><a href="batch-effect-evaluation.html#cb146-2" tabindex="-1"></a><span class="fu">PlotReducedDim</span>(pbmc , <span class="at">group.by =</span> <span class="st">&quot;wnn_har_clusters&quot;</span>, <span class="at">reduction =</span> <span class="st">&quot;wnn.umap.har&quot;</span>, <span class="at">split.by =</span> <span class="st">&quot;orig.ident&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/PlotReducedDim_WNN_har-1.png" width="672" /></p>
</div>
</div>
<div id="feature-level" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Feature level<a href="batch-effect-evaluation.html#feature-level" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At the feature level, SingleCellMQC calculates the percentage of variance (R²) explained by different variables for both RNA and surface protein features. These analyses are performed at single-cell and pseudobulk levels, enabling users to quantify the contribution of batch-specific covariates to feature expression variation. For each feature, the proportion of variance explained (R²) by categorical variables (one-way ANOVA) or continuous covariates (linear regression).</p>
<div id="calculating-per-feature-variance-explained-by-variables-at-cell-level" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Calculating per-feature variance explained by variables at cell level<a href="batch-effect-evaluation.html#calculating-per-feature-variance-explained-by-variables-at-cell-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="batch-effect-evaluation.html#cb147-1" tabindex="-1"></a><span class="co"># Specify &#39;variables&#39; to see the effect of the variable of interest on gene expression</span></span>
<span id="cb147-2"><a href="batch-effect-evaluation.html#cb147-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">RunVarExplainedPerFeature</span>(pbmc, <span class="at">variables =</span><span class="fu">c</span>(<span class="st">&quot;percent.mt&quot;</span>, <span class="st">&quot;nCount_RNA&quot;</span>,<span class="st">&quot;Batch_EXP&quot;</span>), </span>
<span id="cb147-3"><a href="batch-effect-evaluation.html#cb147-3" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;cell&quot;</span>,</span>
<span id="cb147-4"><a href="batch-effect-evaluation.html#cb147-4" tabindex="-1"></a>                       <span class="at">assay =</span> <span class="st">&quot;RNA&quot;</span>)</span>
<span id="cb147-5"><a href="batch-effect-evaluation.html#cb147-5" tabindex="-1"></a></span>
<span id="cb147-6"><a href="batch-effect-evaluation.html#cb147-6" tabindex="-1"></a><span class="co"># Interactive table (top 10)</span></span>
<span id="cb147-7"><a href="batch-effect-evaluation.html#cb147-7" tabindex="-1"></a><span class="fu">PlotVEPerFeature</span>(out, <span class="at">return.type =</span> <span class="st">&quot;interactive_table&quot;</span>, <span class="at">ntop =</span> <span class="dv">10</span>, <span class="at">csv.name=</span><span class="st">&quot;cell_VE&quot;</span>)</span></code></pre></div>
<button onclick="Reactable.downloadDataCSV(&#39;cell_VE_table&#39;, &#39;cell_VE&#39;)">Download as CSV</button>
<p style="color:#000;background:#FFFFFF;text-align:left;font-size:16px;font-style:normal;font-weight:bold;text-decoration:none;text-transform:none;letter-spacing:normal;word-spacing:normal;text-shadow:none;margin-top:0.5px;margin-right:0px;margin-bottom:0.5px;margin-left:0px;">Variance Explained per Feature (top 10)</p>
<div class="reactable html-widget html-fill-item" id="cell_VE_table" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="cell_VE_table">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"feature":["SH3BGRL3","S100A4","RPL15","RACK1","ACTB","RPS13","RPLP0","B2M","RPL4","RPLP1","RPS2","PFN1","UBA52","RPS9","SLC25A6","TMSB4X","MT-ND1","MT-CO1","MT-CO2","MT-ATP8","MT-CO3","MT-ND3","MT-ND4L","MT-ND4","MT-ND5","MT-CYB"],"percent.mt":[24.0013623129403,16.6560698919007,29.596571111909,27.0953698371343,28.3993567135371,32.2088614405974,25.1944000894438,37.5776372227257,20.7866895300542,38.3055526485722,30.4789532604719,27.317272674233,28.8695584892852,32.1380011226055,13.2163256213827,34.7203872056334,40.1736355350366,50.6650169221551,49.7513067114282,45.3693808825805,48.3279469508785,41.9989202616941,39.9849011929364,38.3899576602384,40.8633717862757,44.8812849930572],"nCount_RNA":[11.4686581092795,10.2259844579009,19.5529558085269,19.0767735275374,15.4325167542081,19.5596895563845,19.5732475855653,9.44027825185047,19.5484625208244,18.8973456776539,18.3069466551026,13.0393327035911,18.0035286919785,18.5373204791269,18.0181293736501,12.9704754366985,7.36414113349433,12.8252214068138,13.160358579253,10.3873535600171,12.4721890657627,9.47479114419658,10.579755496154,7.14737815247271,7.95010971733435,12.7161629289945],"Batch_EXP":[20.3860491036321,20.4320901494064,13.568552146117,10.8339543676765,20.6903723026387,12.7472755867319,9.79588333937354,20.7307258923459,9.15196757762814,16.2112398089316,10.8424638211632,21.1962447002245,12.9909443603329,13.6283307890165,7.91976427580093,22.1464049035542,17.2023053224559,16.6147394893449,18.1872511291949,22.7814626266848,21.5741456880298,30.2530770238294,20.0695982252219,17.4014804523178,14.7498780308223,19.7484551152184]},"columns":[{"id":"feature","name":"feature","type":"character","align":"left","filterable":true,"filterInput":{"name":"select","attribs":{"aria-label":"Filter feature","style":{"width":"100%","height":"28px"},"onChange":"function(_e){(function(event){Reactable.setFilter('cell_VE_table', 'feature', event.target.value || undefined)}).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":""},"children":["All"]},{"name":"option","attribs":{},"children":["SH3BGRL3"]},{"name":"option","attribs":{},"children":["S100A4"]},{"name":"option","attribs":{},"children":["RPL15"]},{"name":"option","attribs":{},"children":["RACK1"]},{"name":"option","attribs":{},"children":["ACTB"]},{"name":"option","attribs":{},"children":["RPS13"]},{"name":"option","attribs":{},"children":["RPLP0"]},{"name":"option","attribs":{},"children":["B2M"]},{"name":"option","attribs":{},"children":["RPL4"]},{"name":"option","attribs":{},"children":["RPLP1"]},{"name":"option","attribs":{},"children":["RPS2"]},{"name":"option","attribs":{},"children":["PFN1"]},{"name":"option","attribs":{},"children":["UBA52"]},{"name":"option","attribs":{},"children":["RPS9"]},{"name":"option","attribs":{},"children":["SLC25A6"]},{"name":"option","attribs":{},"children":["TMSB4X"]},{"name":"option","attribs":{},"children":["MT-ND1"]},{"name":"option","attribs":{},"children":["MT-CO1"]},{"name":"option","attribs":{},"children":["MT-CO2"]},{"name":"option","attribs":{},"children":["MT-ATP8"]},{"name":"option","attribs":{},"children":["MT-CO3"]},{"name":"option","attribs":{},"children":["MT-ND3"]},{"name":"option","attribs":{},"children":["MT-ND4L"]},{"name":"option","attribs":{},"children":["MT-ND4"]},{"name":"option","attribs":{},"children":["MT-ND5"]},{"name":"option","attribs":{},"children":["MT-CYB"]}]},"sticky":"left","style":{"background":"#f7f7f7"}},{"id":"percent.mt","name":"percent.mt","type":"numeric","align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["24.001","16.656","29.597","27.095","28.399","32.209","25.194","37.578","20.787","38.306","30.479","27.317","28.87","32.138","13.216","34.72","40.174","50.665","49.751","45.369","48.328","41.999","39.985","38.39","40.863","44.881"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 47.3726523171155%, transparent 47.3726523171155%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 32.8748925861254%, transparent 32.8748925861254%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 58.4161871639814%, transparent 58.4161871639814%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 53.4794449565966%, transparent 53.4794449565966%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 56.0531870682519%, transparent 56.0531870682519%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 63.5721912223677%, transparent 63.5721912223677%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 49.7274088117923%, transparent 49.7274088117923%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 74.1688042470455%, transparent 74.1688042470455%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 41.027696807034%, transparent 41.027696807034%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 75.6055262103776%, transparent 75.6055262103776%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 60.1577875860609%, transparent 60.1577875860609%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 53.9174253434179%, transparent 53.9174253434179%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 56.9812471071354%, transparent 56.9812471071354%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 63.4323307776337%, transparent 63.4323307776337%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 26.0857025700575%, transparent 26.0857025700575%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 68.5293113766843%, transparent 68.5293113766843%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 79.2926519629153%, transparent 79.2926519629153%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 98.1965658629291%, transparent 98.1965658629291%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 89.5477464308142%, transparent 89.5477464308142%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 95.3872117029639%, transparent 95.3872117029639%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 82.895304912705%, transparent 82.895304912705%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 78.9201378425901%, transparent 78.9201378425901%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 75.7721204736261%, transparent 75.7721204736261%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 80.6540178385034%, transparent 80.6540178385034%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 88.5843679121151%, transparent 88.5843679121151%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"nCount_RNA","name":"nCount_RNA","type":"numeric","align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["11.469","10.226","19.553","19.077","15.433","19.56","19.573","9.44","19.548","18.897","18.307","13.039","18.004","18.537","18.018","12.97","7.364","12.825","13.16","10.387","12.472","9.475","10.58","7.147","7.95","12.716"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 58.5935372203501%, transparent 58.5935372203501%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 52.2446998802706%, transparent 52.2446998802706%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.8963290228168%, transparent 99.8963290228168%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 97.46350698392%, transparent 97.46350698392%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 78.8449473534941%, transparent 78.8449473534941%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9307318362904%, transparent 99.9307318362904%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 48.2305157107008%, transparent 48.2305157107008%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.8733727521067%, transparent 99.8733727521067%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 96.5468075496583%, transparent 96.5468075496583%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 93.5304505553967%, transparent 93.5304505553967%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 66.6181360379214%, transparent 66.6181360379214%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 91.9802838710095%, transparent 91.9802838710095%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 94.7074336953546%, transparent 94.7074336953546%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.0548789611077%, transparent 92.0548789611077%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 66.2663432830829%, transparent 66.2663432830829%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 37.6235016764676%, transparent 37.6235016764676%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 65.5242383807174%, transparent 65.5242383807174%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 67.2364589561434%, transparent 67.2364589561434%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 53.0691369156205%, transparent 53.0691369156205%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 63.7205911346085%, transparent 63.7205911346085%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 48.4068425680363%, transparent 48.4068425680363%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 54.0521211408794%, transparent 54.0521211408794%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 36.5160565267854%, transparent 36.5160565267854%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 40.617223496408%, transparent 40.617223496408%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 64.9670570680987%, transparent 64.9670570680987%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"Batch_EXP","name":"Batch_EXP","type":"numeric","align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["20.386","20.432","13.569","10.834","20.69","12.747","9.796","20.731","9.152","16.211","10.842","21.196","12.991","13.628","7.92","22.146","17.202","16.615","18.187","22.781","21.574","30.253","20.07","17.401","14.75","19.748"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 67.3850434703705%, transparent 67.3850434703705%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 67.5372297942212%, transparent 67.5372297942212%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 44.8501556897153%, transparent 44.8501556897153%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 35.811082486396%, transparent 35.811082486396%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 68.390968252061%, transparent 68.390968252061%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 42.1354679945161%, transparent 42.1354679945161%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 32.3797917536045%, transparent 32.3797917536045%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 68.5243549805427%, transparent 68.5243549805427%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 30.2513611108695%, transparent 30.2513611108695%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 53.5854247029565%, transparent 53.5854247029565%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 35.8392100500157%, transparent 35.8392100500157%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 70.063103609358%, transparent 70.063103609358%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 42.9409026728104%, transparent 42.9409026728104%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 45.0477509387949%, transparent 45.0477509387949%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 26.1783760691938%, transparent 26.1783760691938%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 73.2038096029377%, transparent 73.2038096029377%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 56.8613411088933%, transparent 56.8613411088933%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 54.9191722754613%, transparent 54.9191722754613%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 60.1170291368029%, transparent 60.1170291368029%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 75.3029604517269%, transparent 75.3029604517269%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 71.3122360116841%, transparent 71.3122360116841%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 66.3390312642039%, transparent 66.3390312642039%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 57.5197043216834%, transparent 57.5197043216834%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 48.7549680292167%, transparent 48.7549680292167%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 65.2775091263054%, transparent 65.2775091263054%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"showPagination":true,"theme":{"color":"#141415","backgroundColor":"#f8f9fa","borderColor":"#f8f9fa","borderWidth":"1px","stripedColor":"white","highlightColor":"white","cellPadding":4,"tableStyle":{"fontSize":14},"headerStyle":{"borderWidth":"2px","backgroundColor":"#373a3c","color":"#ffffff","transitionDuration":"0.5s","&:hover[aria-sort]":{"color":"#ffffff"},"&[aria-sort='ascending'], &[aria-sort='descending']":{"color":"#ffffff"},"fontSize":14},"groupHeaderStyle":{"&:not(:empty)":{"color":"#141415","fontSize":14},"&:hover":{"fontWeight":"bold","transitionDuration":"1s","transitionTimingFunction":"ease-out","color":"#111111"}},"rowSelectedStyle":{"backgroundColor":"#78c2ad","color":"#ffffff"},"inputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a"},"searchInputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a","borderColor":"#b3cecc","&:focus":{"color":"#888888"}},"selectStyle":{"backgroundColor":"#2780e3","color":"#ffffff","borderColor":"#ffffff","outlineColor":"#ffffff"},"pageButtonStyle":{"backgroundColor":"#ffffff","color":"#2780e3","&:hover":{"backgroundColor":"#2780e3","color":"#ffffff"}},"pageButtonHoverStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonActiveStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonCurrentStyle":{"backgroundColor":"#2780e3","color":"#ffffff"}},"elementId":"cell_VE_table","dataKey":"f2c8194f97b9c1699f529292d1ec94b6"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.filterInput.attribs.onChange","tag.attribs.columns.1.filterMethod","tag.attribs.columns.2.filterMethod","tag.attribs.columns.3.filterMethod"],"jsHooks":[]}</script>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="batch-effect-evaluation.html#cb148-1" tabindex="-1"></a></span>
<span id="cb148-2"><a href="batch-effect-evaluation.html#cb148-2" tabindex="-1"></a><span class="co"># Density plot</span></span>
<span id="cb148-3"><a href="batch-effect-evaluation.html#cb148-3" tabindex="-1"></a><span class="fu">PlotVEPerFeature</span>(out, <span class="at">plot.type=</span><span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/feature_cell-1.png" width="672" /></p>
</div>
<div id="calculating-per-feature-variance-explained-by-variables-at-sample-level" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Calculating per-feature variance explained by variables at sample level<a href="batch-effect-evaluation.html#calculating-per-feature-variance-explained-by-variables-at-sample-level" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="batch-effect-evaluation.html#cb149-1" tabindex="-1"></a><span class="co"># Specify &#39;variables&#39; to see the effect of the variable of interest on gene expression</span></span>
<span id="cb149-2"><a href="batch-effect-evaluation.html#cb149-2" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">RunVarExplainedPerFeature</span>(pbmc, <span class="at">variables =</span><span class="fu">c</span>(<span class="st">&quot;percent.mt&quot;</span>, <span class="st">&quot;nCount_RNA&quot;</span>,<span class="st">&quot;Batch_EXP&quot;</span>), </span>
<span id="cb149-3"><a href="batch-effect-evaluation.html#cb149-3" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&quot;pseudobulk&quot;</span>,</span>
<span id="cb149-4"><a href="batch-effect-evaluation.html#cb149-4" tabindex="-1"></a>                       <span class="at">assay =</span> <span class="st">&quot;RNA&quot;</span>)</span>
<span id="cb149-5"><a href="batch-effect-evaluation.html#cb149-5" tabindex="-1"></a><span class="do">## Warning in FUN(X[[i]], ...): Variable &#39;Batch_EXP&#39; has a unique value for every observation (R2=100% is trivial and uninformative). Skipping.</span></span>
<span id="cb149-6"><a href="batch-effect-evaluation.html#cb149-6" tabindex="-1"></a></span>
<span id="cb149-7"><a href="batch-effect-evaluation.html#cb149-7" tabindex="-1"></a><span class="co"># Interactive table (top 10)</span></span>
<span id="cb149-8"><a href="batch-effect-evaluation.html#cb149-8" tabindex="-1"></a><span class="fu">PlotVEPerFeature</span>(out, <span class="at">return.type =</span> <span class="st">&quot;interactive_table&quot;</span>, <span class="at">ntop =</span> <span class="dv">10</span>, <span class="at">csv.name=</span><span class="st">&quot;sample_VE&quot;</span>)</span></code></pre></div>
<button onclick="Reactable.downloadDataCSV(&#39;sample_VE_table&#39;, &#39;sample_VE&#39;)">Download as CSV</button>
<p style="color:#000;background:#FFFFFF;text-align:left;font-size:16px;font-style:normal;font-weight:bold;text-decoration:none;text-transform:none;letter-spacing:normal;word-spacing:normal;text-shadow:none;margin-top:0.5px;margin-right:0px;margin-bottom:0.5px;margin-left:0px;">Variance Explained per Feature (top 10)</p>
<div class="reactable html-widget html-fill-item" id="sample_VE_table" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="sample_VE_table">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"feature":["THRB","FAM110B","PIP5K1B","NOL8","AL731559.1","PCED1B","ITGB7","RHOF","AL096870.8","AL356804.1","ATAD5","MSI2","AC110285.1","ZNF407","AC006538.3","PLEKHF1","ZNF529","FCAR","KCNG1","LINC01670"],"mean_percent.mt":[92.1343489468506,99.9856549076362,99.9921121641914,92.3834773533319,99.9991219639996,92.2756793168974,92.3817408436019,92.2683561942102,99.9940526506731,99.9973067269308,92.2683359276495,99.9948976645577,99.9991219639996,99.9898332724232,99.9936597540851,92.0045757457203,92.27786886833,99.9974510951836,92.1940381094827,92.1771464069411],"mean_nCount_RNA":[99.9959813239578,91.8156914737766,92.8265557484346,99.9988432761527,92.3551330911068,99.9960797225659,99.9946593878612,99.9974856487991,92.8604528567721,92.2706801202981,99.9965032073677,92.6544257697547,92.3551330911068,92.2013206041294,92.8668070766038,99.9927299955444,99.9983496843177,92.6732498105203,99.997020730804,99.9960262143672]},"columns":[{"id":"feature","name":"feature","type":"character","align":"left","filterable":true,"filterInput":{"name":"select","attribs":{"aria-label":"Filter feature","style":{"width":"100%","height":"28px"},"onChange":"function(_e){(function(event){Reactable.setFilter('sample_VE_table', 'feature', event.target.value || undefined)}).apply(event.target,[_e])}"},"children":[{"name":"option","attribs":{"value":""},"children":["All"]},{"name":"option","attribs":{},"children":["THRB"]},{"name":"option","attribs":{},"children":["FAM110B"]},{"name":"option","attribs":{},"children":["PIP5K1B"]},{"name":"option","attribs":{},"children":["NOL8"]},{"name":"option","attribs":{},"children":["AL731559.1"]},{"name":"option","attribs":{},"children":["PCED1B"]},{"name":"option","attribs":{},"children":["ITGB7"]},{"name":"option","attribs":{},"children":["RHOF"]},{"name":"option","attribs":{},"children":["AL096870.8"]},{"name":"option","attribs":{},"children":["AL356804.1"]},{"name":"option","attribs":{},"children":["ATAD5"]},{"name":"option","attribs":{},"children":["MSI2"]},{"name":"option","attribs":{},"children":["AC110285.1"]},{"name":"option","attribs":{},"children":["ZNF407"]},{"name":"option","attribs":{},"children":["AC006538.3"]},{"name":"option","attribs":{},"children":["PLEKHF1"]},{"name":"option","attribs":{},"children":["ZNF529"]},{"name":"option","attribs":{},"children":["FCAR"]},{"name":"option","attribs":{},"children":["KCNG1"]},{"name":"option","attribs":{},"children":["LINC01670"]}]},"sticky":"left","style":{"background":"#f7f7f7"}},{"id":"mean_percent.mt","name":"mean_percent.mt","type":"numeric","align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["92.134","99.986","99.992","92.383","99.999","92.276","92.382","92.268","99.994","99.997","92.268","99.995","99.999","99.99","99.994","92.005","92.278","99.997","92.194","92.177"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.1351579267062%, transparent 92.1351579267062%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9865328253899%, transparent 99.9865328253899%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9929901386426%, transparent 99.9929901386426%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.3842885206438%, transparent 92.3842885206438%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.2764895376954%, transparent 92.2764895376954%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.3825519956665%, transparent 92.3825519956665%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.269166350708%, transparent 92.269166350708%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9949306421627%, transparent 99.9949306421627%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9981847469926%, transparent 99.9981847469926%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.2691460839693%, transparent 92.2691460839693%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9957756634669%, transparent 99.9957756634669%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9907112268648%, transparent 99.9907112268648%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9945377421249%, transparent 99.9945377421249%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.0053835861104%, transparent 92.0053835861104%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.2786791083533%, transparent 92.2786791083533%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9983291165131%, transparent 99.9983291165131%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.1948476134353%, transparent 92.1948476134353%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.1779557625771%, transparent 92.1779557625771%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]},{"id":"mean_nCount_RNA","name":"mean_nCount_RNA","type":"numeric","align":"left","filterable":true,"filterMethod":"function(rows, columnId, filterValue) {\n                  return rows.filter(function(row) {\n                    return row.values[columnId] >= filterValue\n                  })\n                }","cell":["99.996","91.816","92.827","99.999","92.355","99.996","99.995","99.997","92.86","92.271","99.997","92.654","92.355","92.201","92.867","99.993","99.998","92.673","99.997","99.996"],"style":[{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9971380146998%, transparent 99.9971380146998%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 91.8167535400606%, transparent 91.8167535400606%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.827629507762%, transparent 92.827629507762%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 100%, transparent 100%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.3562013973128%, transparent 92.3562013973128%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9972364144461%, transparent 99.9972364144461%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.995816063312%, transparent 99.995816063312%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9986423569422%, transparent 99.9986423569422%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.8615270082%, transparent 92.8615270082%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.2717474496052%, transparent 92.2717474496052%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9976599041466%, transparent 99.9976599041466%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.6554975379906%, transparent 92.6554975379906%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.3562013973128%, transparent 92.3562013973128%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.2023871311291%, transparent 92.2023871311291%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.8678813015333%, transparent 92.8678813015333%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9938866486771%, transparent 99.9938866486771%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9995064024554%, transparent 99.9995064024554%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 92.6743217965009%, transparent 92.6743217965009%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9981774335693%, transparent 99.9981774335693%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"},{"backgroundImage":"linear-gradient(90deg, #A6CEE3 99.9971829056285%, transparent 99.9971829056285%)","backgroundSize":"92% 80%","backgroundRepeat":"no-repeat","backgroundPosition":"left","color":"black"}]}],"filterable":true,"defaultPageSize":10,"showPageSizeOptions":true,"showPagination":true,"theme":{"color":"#141415","backgroundColor":"#f8f9fa","borderColor":"#f8f9fa","borderWidth":"1px","stripedColor":"white","highlightColor":"white","cellPadding":4,"tableStyle":{"fontSize":14},"headerStyle":{"borderWidth":"2px","backgroundColor":"#373a3c","color":"#ffffff","transitionDuration":"0.5s","&:hover[aria-sort]":{"color":"#ffffff"},"&[aria-sort='ascending'], &[aria-sort='descending']":{"color":"#ffffff"},"fontSize":14},"groupHeaderStyle":{"&:not(:empty)":{"color":"#141415","fontSize":14},"&:hover":{"fontWeight":"bold","transitionDuration":"1s","transitionTimingFunction":"ease-out","color":"#111111"}},"rowSelectedStyle":{"backgroundColor":"#78c2ad","color":"#ffffff"},"inputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a"},"searchInputStyle":{"backgroundColor":"#ffffff","color":"#9a9a9a","borderColor":"#b3cecc","&:focus":{"color":"#888888"}},"selectStyle":{"backgroundColor":"#2780e3","color":"#ffffff","borderColor":"#ffffff","outlineColor":"#ffffff"},"pageButtonStyle":{"backgroundColor":"#ffffff","color":"#2780e3","&:hover":{"backgroundColor":"#2780e3","color":"#ffffff"}},"pageButtonHoverStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonActiveStyle":{"backgroundColor":"#2780e3","color":"#ffffff"},"pageButtonCurrentStyle":{"backgroundColor":"#2780e3","color":"#ffffff"}},"elementId":"sample_VE_table","dataKey":"422813b1ba97fce16b5e928a9d77f594"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.0.filterInput.attribs.onChange","tag.attribs.columns.1.filterMethod","tag.attribs.columns.2.filterMethod"],"jsHooks":[]}</script>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="batch-effect-evaluation.html#cb150-1" tabindex="-1"></a></span>
<span id="cb150-2"><a href="batch-effect-evaluation.html#cb150-2" tabindex="-1"></a><span class="co"># Density plot</span></span>
<span id="cb150-3"><a href="batch-effect-evaluation.html#cb150-3" tabindex="-1"></a><span class="fu">PlotVEPerFeature</span>(out, <span class="at">plot.type=</span><span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/feature_sample-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="feature-qc.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="qc-html-report.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
